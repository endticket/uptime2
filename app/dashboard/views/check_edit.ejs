<script src="/dashboard/javascripts/checkState.js"></script>


<div class="portlet box green">
  <div class="portlet-title">
    <div class="caption"> 
      Edit check "<%= check.name %>"
    </div>
  </div>
  <div class="portlet-body form">
    <% if (info.length) { %>
    <div class="alert alert-success"><%= info %></div>
    <% } %>
    <div style="float: right;">
      <span id="check_24h"></span>
    </div>
    <%- partial('_check_details', { check: check, pollerCollection: pollerCollection, pollerDetails: pollerDetails, route: '/dashboard' }) %>
  </div>
</div>

<script>
jQuery(document).ready(function($) {
  // highlight current section in main nav
  $('.sub-menu li').eq(1).addClass('active');

  // update check state live
  updateCheckState(<%- JSON.stringify(check) %>);
  socket.on('CheckEvent', function() {
    $.getJSON('/api/checks/<%= check._id %>', updateCheckState);
  });
  
  // manage pause
  $('button[name="pause"]').click(function(e) {
    var button = $(this).children();
    $.getJSON('/api/checks/<%= check._id %>/pause', function() {
      if(button.hasClass('icon-pause')) {
        button.removeClass('icon-pause');
        button.addClass('icon-play');
      } else {
        button.removeClass('icon-play');
        button.addClass('icon-pause');
      }
    });
    e.preventDefault();
  });

});
</script>
